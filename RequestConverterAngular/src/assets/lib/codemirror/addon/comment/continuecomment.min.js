!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(s){var t=/\S/g,d=String.prototype.repeat||function(e){return Array(e+1).join(this)};function o(n){if(n.getOption("disableInput"))return s.Pass;for(var e,t=n.listSelections(),o=[],i=0;i<t.length;i++){var l=t[i].head;if(!/\bcomment\b/.test(n.getTokenTypeAt(l)))return s.Pass;var c=n.getModeAt(l);if(e){if(e!=c)return s.Pass}else e=c;var r,m,u,c=null,a=e.blockCommentStart,f=e.lineComment;if(a&&e.blockCommentContinue&&(-1!=(u=(r=n.getLine(l.line)).lastIndexOf(e.blockCommentEnd,l.ch-e.blockCommentEnd.length))&&u==l.ch-e.blockCommentEnd.length||f&&-1<(m=r.lastIndexOf(f,l.ch-1))&&/\bcomment\b/.test(n.getTokenTypeAt({line:l.line,ch:m+1}))||(l.ch>=a.length&&-1<(m=r.lastIndexOf(a,l.ch-a.length))&&u<m?c=p(0,r)>=m?r.slice(0,m):(a=n.options.tabSize,m=s.countColumn(r,m,a),n.options.indentWithTabs?d.call("\t",u=Math.floor(m/a))+d.call(" ",m-a*u):d.call(" ",m)):-1<(m=r.indexOf(e.blockCommentContinue))&&m<=l.ch&&m<=p(0,r)&&(c=r.slice(0,m))),null!=c&&(c+=e.blockCommentContinue)),null==c&&f&&function(e){e=e.getOption("continueComments");return!e||"object"!=typeof e||!1!==e.continueLineComment}(n)&&(m=(r=null==r?n.getLine(l.line):r).indexOf(f),l.ch||m?-1<m&&p(0,r)>=m&&(c=(c=(c=-1<p(l.ch,r))?c:-1<(u=(a=n.getLine(l.line+1)||"").indexOf(f))&&p(0,a)>=u||null)&&r.slice(0,m)+f+r.slice(m+f.length).match(/^\s*/)[0]):c=""),null==c)return s.Pass;o[i]="\n"+c}n.operation(function(){for(var e=t.length-1;0<=e;e--)n.replaceRange(o[e],t[e].from(),t[e].to(),"+insert")})}function p(e,n){t.lastIndex=e;e=t.exec(n);return e?e.index:-1}s.defineOption("continueComments",null,function(e,n,t){t&&t!=s.Init&&e.removeKeyMap("continueComment"),n&&(t="Enter","string"==typeof n?t=n:"object"==typeof n&&n.key&&(t=n.key),(n={name:"continueComment"})[t]=o,e.addKeyMap(n))})});