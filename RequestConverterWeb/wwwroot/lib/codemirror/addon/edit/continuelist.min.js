!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(c){"use strict";var u=/^(\s*)(>[> ]*|[*+-] \[[x ]\]\s|[*+-]\s|(\d+)([.)]))(\s*)/,f=/^(\s*)(>[> ]*|[*+-] \[[x ]\]|[*+-]|(\d+)[.)])(\s*)$/,p=/[*+-]\s/;c.commands.newlineAndIndentContinueMarkdownList=function(e){if(e.getOption("disableInput"))return c.Pass;for(var n=e.listSelections(),t=[],i=0;i<n.length;i++){var r=n[i].head,o=e.getStateAfter(r.line),l=c.innerMode(e.getMode(),o);if("markdown"!==l.mode.name&&"markdown"!==l.mode.helperType)return void e.execCommand("newlineAndIndent");var l=!1!==(o=l.state).list,o=0!==o.quote,s=e.getLine(r.line),d=u.exec(s),a=/^\s*$/.test(s.slice(0,r.ch));if(!n[i].empty()||!l&&!o||!d||a)return void e.execCommand("newlineAndIndent");f.test(s)?(l=o&&/>\s*$/.test(s),a=!/>\s*$/.test(s),(l||a)&&e.replaceRange("",{line:r.line,ch:0},{line:r.line,ch:r.ch+1}),t[i]="\n"):(o=d[1],s=d[5],a=(l=!(p.test(d[2])||0<=d[2].indexOf(">")))?parseInt(d[3],10)+1+d[4]:d[2].replace("x"," "),t[i]="\n"+o+a+s,l&&function(e,n){var t=n.line,i=0,r=0,o=u.exec(e.getLine(t)),l=o[1];do{var s=t+(i+=1),d=e.getLine(s),a=u.exec(d);if(a){var c=a[1],f=parseInt(o[3],10)+i-r,p=parseInt(a[3],10),m=p;if(l!==c||isNaN(p)){if(l.length>c.length)return;if(l.length<c.length&&1===i)return;r+=1}else f===p&&(m=p+1),p<f&&(m=1+f),e.replaceRange(d.replace(u,c+m+a[4]+a[5]),{line:s,ch:0},{line:s,ch:d.length})}}while(a)}(e,r))}e.replaceSelections(t)}});